import pandas as pd

class MarkerCollection:
    """
    MarkerCollection holds translations from different occuring marker names to the standarised names.
    """

    MARKER_DICT = {
        "FSPEAK": "FSC-H",
        "FS PEAK": "FSC-H",
        "FSTOF": "FSC-W",
        "FS TOF": "FSC-W",
        "FSINT": "FSC-A",
        "FS INT": "FSC-A",
        "SSTOF": "SSC-W",
        "SS TOF": "SSC-W",
        "SSINT": "SSC-A",
        "SS INT": "SSC-A",
        "SSPEAK": "SSC-H",
        "SS PEAK": "SSC-H",
        "SYTO 41": "SY41",
        "Syto 41": "SY41",
        "SY41 LOG": "SY41",
        "SYTO41 LOG" : "SY41",
        "CD1A": "CD1",
        "CD3BV605": "CD3",
        "ICD3": "ICD3",
        "CD3PG": "CD3",
        "CD4AX700": "CD4",
        "CD5PE": "CD5",
        "CD5PC7": "CD5",
        "CD5ECD": "CD5",
        "CD7ECD": "CD7",
        "CD7PC55": "CD7",
        "CD8AX750": "CD8",
        "CD10PE": "CD10",
        "CD10PC5": "CD10",
        "CD10PC55": "CD10",
        "CD48BL": "CD48",
        "CD16BV605": "CD16",
        "CD10+16": "CD10CD16",
        "CD11C": "CD11C",
        "CD11b": "CD11B",
        "CD11A": "CD11A",
        "CD11a": "CD11A",
        "CD20 LOG": "CD20",
        "CD38 LOG": "CD38",
        "CD20APC-A750": "CD20",
        "CD20BC": "CD20",
        "CD16+56": "CD56CD16",
        "CD56CD16": "CD56CD16",
        "CD56CD16KO": "CD56CD16",
        "CD56+16": "CD56CD16",
        "CD56+CD16": "CD56CD16",
        "CD16+CD56APC": "CD56CD16",
        "CD16CD56": "CD56CD16",
        "CD99APC": "CD99",
        "CD99PE": "CD99",
        "CD99FITC": "CD99",
        "CD312APC": "CD312",
        # until here T-ALL
        "CD13_19": "CD13CD19",
        "CD15-FITC": "CD15",
        "CD117-PC5.5": "CD117",
        "CD33-PC7": "CD33",
        "CD13-APC": "CD13",
        "CD34+CD99": "CD34CD99",
        "13": "CD13",
        "CD11B-APC-A750": "CD11B",
        "CD11B-A750": "CD11B",
        "HLA-DR-PB": "HLA-DR",
        "HLADR-PB": "HLA-DR",
        "CD45 LOG": "CD45",
        "CD45-KRO": "CD45",  # kein CD35KR?
        "CD45KA": "CD45",  # kein CD45 KA? wenn nicht oft vorkommen --> entfernen
        "CD45RA-A750": "CD45RA",
        "CD38-FITC": "CD38",
        "CD38APC-A700": "CD38",
        "CD38BC1UL": "CD38",
        "CD38APC-AX700": "CD38",
        "CD99-PE": "CD99",
        "CD371-APC": "CD371",
        "CD123-APC-A700": "CD123",
        "CD45RA-APC-A750": "CD45RA",
        "CD45RABV510": "CD45RA",
        "CD7_19": "CD7CD19",
        "CD7_CD19": "CD7CD19",
        "CD34-ECD": "CD34",
        "CD34ECD": "CD34",
        "CD34BV605": "CD34",
        "CD14-APC-A700": "CD14",
        "CD14-A700": "CD14",
        "CD19+7-PE": "CD7CD19",
        "CD7+19": "CD7CD19",
        "CD19+CD7-PE": "CD7CD19",
        "CD10+CD371": "CD10CD371",
        "CD7+CD19": "CD7CD19",
        "CD381UL": "CD381",
        "CD992UL": "CD992",

        "CD7_56": "CD7CD56",
        "CD7/56": "CD7CD56",
        "CD19/56": "CD19CD56",
        "CD7-CD13": "CD7CD13",
        "CD7VCD56": "CD7CD56",
        "CD56CD7": "CD7CD56",
        "CD58FITC": "CD58",
        "CD123-A700": "CD123",
        "CD123PE": "CD123",

        "CD19PECY7": "CD19",
        "CD19PC7": "CD19",
        "CD11APE": "CD11A",
        "CD20AX750": "CD20",
        "CD38AX700": "CD38",
        "CD71ULBIOLEGEND": "CD71",
        "CD101UL": "CD101",
        "CD79A": "CD79",
        "CLL1-APC": "CD371",
        "CLL1": "CD371",
        "CLL-1": "CD371",
        "CLL": "CD371",
        "CD20BC": "CD20",
        "CD117BV605": "CD117",
        "HLADR": "HLA-DR",
        # "CD33FEHLT": "CD33",  # ???! --> raussuchen
        # "HLA-DRFEHLT": "HLA-DR",  # ???!
    }

    @staticmethod
    def renameMarkers(events: pd.DataFrame):

        renameDict = {k: v for k, v in MarkerCollection.MARKER_DICT.items() if k in events.columns and not v in events.columns}
        if len(renameDict) > 0:
            events.rename(columns=renameDict, inplace=True)

        return events
